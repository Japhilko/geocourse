VG250 <- readOGR ("VG250_GEM.shp","VG250_GEM")
bla <- substr(VG250@data$AGS_0,1,2)
plot(VG250[bla=="11",])
ham_map_z12 <- qmap("Hamburg", zoom = 12)
date()
getwd()
setwd("D:/github/geocourse")
main_path <- "D:/github/geocourse"
slide_path <- paste0(main_path,"slides/")
rcode_path <- paste0(main_path,"rcode/")
dirnamen <- dir()
dirnamen
#-------------------------------------------------#
# Parts of the presentation
#-------------------------------------------------#
setwd(slide_path)
dirnamen <- dir()
main_path <- "D:/github/geocourse"
main_path <- "D:/github/geocourse/"
slide_path <- paste0(main_path,"slides/")
rcode_path <- paste0(main_path,"rcode/")
#-------------------------------------------------#
# Parts of the presentation
#-------------------------------------------------#
setwd(slide_path)
dirnamen <- dir()
dirnamen
presparts <- dirnamen[grep(".Rmd",dirnamen)]
presparts
# setwd("D:/gitlab/IntroDataAnalysis/rcode/")
setwd(rcode_path)
for (i in 1:length(presparts)){
purl(paste0("../slides/",presparts[i]),documentation = 2)
}
presparts
i
length(presparts)
install.packages("choroplethr")
install.packages("choroplethrMaps")
vec_a <- c("A",2,6,1,"C")
vec_b <- c(1,"C",2)
match(vec_a,vec_b)
data(land)
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE,warning=F,cache=T,fig.height=4)
# Chunk 2
library(knitr)
library(DT)
Ex <- T
# Chunk 3
# install.packages("tmap")
library(tmap)
# Chunk 4
data(Europe)
qtm(Europe)
# Chunk 5
EUR <- Europe@data
# Chunk 7
kable(Europe@data[,1:4])
# Chunk 8
qtm(Europe, fill="gdp_cap_est")
# Chunk 9
qtm(Europe, fill="gdp_cap_est", text="iso_a3")
# Chunk 10
qtm(Europe, fill="gdp_cap_est", text="iso_a3",
text.size="AREA", root=5, fill.title="GDP per capita",
fill.textNA="Non-European countries", theme="Europe")
# Chunk 11
qtm(Europe, fill="pop_est_dens",
fill.title="Population density")
# Chunk 12
library(XML)
info <- colnames(Europe@data)
info_df <- data.frame(Europe@data)
kable(info_df[1:8,1:6])
# Chunk 13
link <- "http://userpage.chemie.fu-berlin.de/diverse/doc/ISO_3166.html"
Tab <- readHTMLList(link)
Tab <- strsplit(x = Tab[[1]],split = "\n")
Tab3 <- Tab[[3]]
Tab4 <- Tab3[-c(1:7)]
Tab4
# Chunk 14
qtm(Europe, fill="continent")
# Chunk 15
qtm(Europe, fill="part",fill.title="part of Europe")
# Chunk 16
qtm(Europe, fill="area") # Russia is huge
# Chunk 17
qtm(Europe, fill="pop_est",fill.title="Population")
# Chunk 18
qtm(Europe, fill="pop_est_dens",
fill.title="Population density")
# Chunk 19
qtm(Europe, fill="economy")
# Chunk 20
qtm(Europe, fill="income_grp",fill.title="Income group")
# Chunk 22
data(World)
kable(World@data[1:15,])
# Chunk 23
qtm(World, fill="income_grp",fill.title="Income group")
# Chunk 25
data(NLD_prov)
NLD_df <- NLD_prov@data
kable(head(NLD_df))
# Chunk 26
qtm(NLD_prov, fill="population",fill.title="population")
# Chunk 27
pop <- NLD_prov@data$population
pop
# Chunk 28
popmen <- NLD_prov@data$pop_men
popmen
# Chunk 29
prop <- popmen/pop
prop
# Chunk 31
barplot(prop,col="blue")
# Chunk 32
NLD_prov@data$proportion <- prop
# Chunk 33
qtm(NLD_prov, fill="proportion",fill.title="proportion")
# Chunk 34
ant <- runif(length(NLD_prov),.18,.28)
NLD_prov@data$pop_65plus <-
round(NLD_prov@data$population*ant)
pop65plus <- NLD_prov@data$pop_65plus
prop65plus <- pop65plus/pop
NLD_prov@data$proportion65plus <- prop65plus
# Chunk 35
qtm(NLD_prov, fill="proportion",fill.title="proportion")
# Chunk 36
data(NLD_muni)
# Chunk 38
NLD_df <- NLD_muni@data
NLD_df[,6] <- round(NLD_df[,6])
kable(NLD_df[,c("name","province","population")])
# Chunk 39
qtm(NLD_muni, fill="population")
# Chunk 40
tm_shape(Europe) +
tm_fill(c("pop_est_dens", "gdp_cap_est"),
title=c("Population density", "GDP per capita"))
# + tm_layout_Europe()
data(land)
info_df <- land@data[1:100,]
datatable(info_df)
data(land)
info_df <- land@data[1:15,]
kable(info_df)
info_df <- land@data[sample(1:length(land),10,replace=T),]
kable(info_df)
tm_shape(land,  relative=FALSE) +
tm_raster(title="Global Land Cover")
?tm_raster
tm_shape(land,  relative=FALSE) +
tm_raster("cover", title="Global Land Cover")
tm_shape(land,  relative=FALSE) +
tm_raster("trees", title="Global Land Cover")
head(land)
head(info_df)
?land
kable(Unemp[1:8,c(2,3,4,5)])
url <- "https://raw.githubusercontent.com/Japhilko/
GeoData/master/2015/data/Unemployment07a13.csv"
Unemp <- read.csv(url)
kable(Unemp[1:10,c(2,3,4,5)])
Unemp
kable(Unemp[1:10,])
qtm(Europe, fill="gdp_cap_est", text="iso_a3",
text.size="AREA", fill.title="GDP per capita",
fill.textNA="Non-European countries", theme="Europe")
head(Europe@data)
tm_shape(Europe) +
tm_fill(c("pop_est", "economy"),
title=c("Population", "Economy"))
kable(info_df[,1:2])
kable(info_df[,c(1,3)])
kable(info_df[,c(2,3)])
dat1 <- opq(bbox = 'Ladenburg') %>%
add_osm_feature(key = 'shop', value = 'bakery') %>%
osmdata_sf ()
library(magrittr)
dat1 <- opq(bbox = 'Ladenburg') %>%
add_osm_feature(key = 'shop', value = 'bakery') %>%
osmdata_sf ()
library(osmdata)
library(magrittr)
dat1 <- opq(bbox = 'Ladenburg') %>%
add_osm_feature(key = 'shop', value = 'bakery') %>%
osmdata_sf ()
dat1
unlist(dat1)
unlist(lapply(dat1,nrow))
dat <- sf::st_read ('../data/Ladenburg_amenity.osm',
layer = 'points',
quiet = TRUE)
getwd()
setwd("slides")
dat <- sf::st_read ('../data/Ladenburg_amenity.osm',
layer = 'points',
quiet = TRUE)
unlist(lapply(dat,nrow))
dat
dat@data
nrow(dat)
?osmdata_sf
tm_shape(sfc)
library(tmap)
tm_shape(sfc)
ls <- st_linestring(bb_poly)
library(dplyr)
library(sf)
ls <- st_linestring(bb_poly)
bb_poly <- getbb(place_name = "Ladenburg",
format_out = "polygon")
ls <- st_linestring(bb_poly)
sfc <- st_sfc(ls)
tm_shape(sfc)
tm_basemap(sfc)
tm_polygons(sfc)
qtm(sfc)
?tm_bubbles
qtm(sfc) + tm_bubbles(dat, size=2)
tm_bubbles(dat, size=2)
tm_shape(sfc)
World
unemp <-read.csv("https://raw.githubusercontent.com/Japhilko/GeoData/master/2015/data/Unemployment.csv")
head(unemp)
library(maptools)
data("wrld_simpl")
ind <- match(unemp$geo,wrld_simpl@data$NAME)
ind
ind <- match(unemp$geo[-1:5],wrld_simpl@data$NAME)
ind <- match(unemp$geo[-c(1:5)],wrld_simpl@data$NAME)
ind
unemp <- unemp[-c(1:5),]
ind <- match(unemp$geo,wrld_simpl@data$NAME)
mymap <- wrld_simpl[ind,]
mymap$X2014M10 <- unemp$X2014M10
sp::spplot(mymap,"X2014M10")
?df_pop_county
# install.packages("choroplethr")
library("choroplethr")
?df_pop_county
?county_choropleth
?df_president_ts
kable(df_president_ts[8:16,1:8])
kable(df_president_ts[42:48,42:48])
# Chunk 1: setup
knitr::opts_chunk$set(message=F,warning=F,cache=T,fig.height=4)
library(knitr)
sol <- F
# Chunk 3
library(maptools)
data(wrld_simpl)
# Chunk 4
kable(head(wrld_simpl@data[,c("ISO2","NAME","AREA","POP2005")]))
# Chunk 5
plot(wrld_simpl)
# Chunk 6
gini <- read.csv("../data/gini-index_csv.csv")
# Chunk 7
kable(head(gini))
# Chunk 8
gini12 <- gini[gini$Year==2012,]
summary(gini12$Value)
# Chunk 9
vec_a <- c("A",2,6,1,"C")
vec_b <- c(1,"C",2)
match(vec_a,vec_b)
# Chunk 10
ind <- match(gini12$Country.Code,wrld_simpl$ISO3)
# Chunk 11
ind2 <- ind[!is.na(ind)]
# Chunk 12
ginimap <- wrld_simpl[ind2,]
# Chunk 13
ginimap@data$gini12 <- gini12$Value[!is.na(ind)]
# Chunk 14
library(sp)
spplot(ginimap,"gini12")
# Chunk 15
unemp <-read.csv("https://raw.githubusercontent.com/Japhilko/GeoData/master/2015/data/Unemployment.csv")
library(maptools)
data("wrld_simpl")
unemp <- unemp[-c(1:5),]
ind <- match(unemp$geo,wrld_simpl@data$NAME)
mymap <- wrld_simpl[ind,]
mymap$X2014M10 <- unemp$X2014M10
sp::spplot(mymap,"X2014M10")
# Chunk 16
library(knitr)
library(DT)
internet <- F
Nint <- !internet
par(mai=c(0,0,0,0))
# Chunk 18
# install.packages("choroplethr")
library("choroplethr")
data(df_pop_state)
# Chunk 19
datatable(df_pop_state,options = list(pageLength = 5))
# Chunk 20
kable(head(df_pop_state))
# Chunk 21
state_choropleth(df_pop_state)
# Chunk 22
state_choropleth(df_pop_state, title="2012 US State Population Estimates", legend="Population")
# Chunk 23
state_choropleth(df_pop_state,
title= "2012 Population Estimates",
legend= "Population", num_colors = 1,
zoom=c("california","washington","oregon"))
# Chunk 25
data(df_pop_county)
county_choropleth(df_pop_county)
# Chunk 27
data(df_pop_country)
country_choropleth(df_pop_country,
title      = "2012 Population Estimates",
legend     = "Population",
num_colors = 1,
zoom       = c("united states of america",
"mexico", "canada"))
# Chunk 28
library(WDI)
choroplethr_wdi(code="SP.POP.TOTL", year=2012,
title="2012 Population",
num_colors=1)
# Chunk 29
choroplethr_wdi(code="SP.DYN.LE00.IN", year=2012,
title="2012 Life Expectancy")
# Chunk 30
data(df_president_ts)
kable(df_president_ts[42:48,42:48])
kable(df_president_ts[42:48,c(1,22:28)])
kable(df_president_ts[42:48,c(1,32:38)])
# Chunk 1: setup
knitr::opts_chunk$set(echo = FALSE,cache=T)
GESIS <- F
athome <- !GESIS
# Chunk 2
setwd("D:/Daten/Daten/GeoDaten/")
library(maptools)
onb <- readShapePoly("onb_grenzen.shp")
# Chunk 3
par(mai=c(0,0,0,0))
plot(onb)
# Chunk 4
vwb <- onb@data$ONB_NUMMER
vwb1 <- substr(vwb, 1,1)
# Chunk 5
barchart(table(vwb1),col="royalblue",
xlab="HÃ¤ufigkeit")
# Chunk 6
vwb6 <- onb[vwb1==6,]
plot(vwb6)
# Chunk 7
vwb6c <- unionSpatialPolygons(vwb6,
rep(1,length(vwb6)))
plot(vwb6c,col="royalblue")
# Chunk 8
data_path <- "D:/GESIS/data/"
# Chunk 9
data_path <- "D:/Daten/Daten/GeoDaten/"
# Chunk 10
library(rgdal)
# Chunk 11
setwd(data_path)
plz <- readOGR ("post_pl.shp","post_pl")
# Chunk 12
plzbereich <- substr(plz@data$PLZ99,1,2)
plot(plz[plzbereich=="68",])
# Chunk 13
ma_map <- plz[plz$PLZORT99=="Mannheim",]
plot(ma_map)
# Chunk 14
library(maptools)
ma_map2 <- unionSpatialPolygons(SpP = ma_map,
IDs = rep(1,length(ma_map)))
plot(ma_map2)
# Chunk 15
ddat <- maptools::unionSpatialPolygons(SpP = plz,
IDs = rep(1,length(plz)))
# Chunk 17
# set.seed(323)
set.seed(5)
n <- 1000
spatsamp <- spsample(ddat,n,type="random")
# Chunk 18
library(ggmap)
load(paste0("../data/spatsamp_",sampplz,".RData"))
load(paste0("../data/spatsamp_Deutschland.RData"))
getwd()
setwd("slides")
load(paste0("../data/spatsamp_Deutschland.RData"))
plot(ddat)
load("../data/ddat.RData")
plot(ddat)
points(spatsamp)
plot(ddat)
points(spatsamp,pch=20)
points(spatsamp[ind_str,],pch=20,col="green")
install.packages("SoDA")
install.packages("mapdata")
DEU3 <- getData('GADM', country='DEU', level=3)
setwd("../data/")
library(raster)
DEU3 <- getData('GADM', country='DEU', level=3)
plot(DEU3)
library(sf)
nc
demo(nc, ask = FALSE, echo = FALSE)
plot(st_geometry(nc))
str(nc)
head(nc)
plot(nc)
geodata_path <- "D:/Daten/Daten/GeoDaten/"
geodata_path <- "D:/Daten/Daten/GeoDaten/"
setwd(geodata_path)
fname <- system.file("post_pl.shp", package="sf")
plz <- st_read(fname)
setwd(data_path)
data_path <- "D:/GESIS/data/"
setwd(data_path)
fname <- system.file("post_pl.shp", package="sf")
plz <- st_read(fname)
plz <- st_read("post_pl.shp")
plz
plot(plz)
library(osmdata)
bb_poly <- getbb(place_name = "Amsterdam",
format_out = "polygon")
pol <- sf::st_polygon(bb_poly)
pol
str(plz)
st_as_sfc(pol)
st_geometrycollection(list(pol))
ab <- st_geometrycollection(list(pol))
str(ab)
ab <- st_geometrycollection(pol)
ab <- st_polygonize(pol)
ab <- st_polygonize(bb_poly)
ab <- st_polygonize(pol)
ls <- st_multilinestring(bb_poly)
ab <- st_polygonize(ls)
str(ab)
plot(ab)
bb_poly_lu <- getbb(place_name = "Ludwigshafen",
format_out = "polygon")
bb_poly_lu <- getbb(place_name = "Mannheim",
format_out = "polygon")
bb_poly_hd <- getbb(place_name = "Heidelberg",
format_out = "polygon")
ls <- st_multilinestring(bb_poly_ma)
bb_poly_ma <- getbb(place_name = "Mannheim",
format_out = "polygon")
ls <- st_multilinestring(bb_poly_ma)
bb_poly_ma <- getbb(place_name = "Mannheim",
format_out = "polygon")
ls <- st_multilinestring(bb_poly_ma)
bb_poly_hd <- getbb(place_name = "Heidelberg",
format_out = "polygon")
ls <- st_multilinestring(bb_poly_hd)
ab <- st_polygonize(ls)
plot(ab)
bbox <- get_bbox (c (-0.13, 51.51, -0.11, 51.52))
library(osmdata)
bbox <- get_bbox (c (-0.13, 51.51, -0.11, 51.52))
library(osmplotr)
bbox <- get_bbox (c (-0.13, 51.51, -0.11, 51.52))
dat_B <- extract_osm_objects (key = 'building', bbox = bbox)
dat_B
plot(dat_B)
?get_bbox
bbox <- get_bbox (c (-0.13, 51.5, -0.11, 51.52))
map <- osm_basemap (bbox = bbox, bg = 'gray20')
plot(map)
print_osm_map (map)
bbox <- osmplotr::get_bbox ("Mannheim")
bbox <- osmplotr::bbox ("Mannheim")
library(sf)
bb_poly <- getbb(place_name = "Amsterdam",
format_out = "polygon")
ls <- st_multilinestring(bb_poly)
pol <- sf::st_polygon(bb_poly)
class(pol)
ab <- st_polygonize(ls)
ab <- st_geometrycollection(list(pol))
str(ab)
bb_poly_ma <- getbb(place_name = "Mannheim",
format_out = "polygon")
bb_poly_ma <- getbb(place_name = "Mannheim",
format_out = "polygon")
ls <- st_multilinestring(bb_poly_ma)
bb_poly_ma <- getbb(place_name = "Mannheim",
format_out = "polygon")
ls <- st_multilinestring(bb_poly_ma)
bb_poly_ma <- getbb(place_name = "Mannheim",
format_out = "polygon")
plot(bb_poly_ma)
bb_poly_hd <- getbb(place_name = "Heidelberg",
format_out = "polygon")
ls <- st_multilinestring(bb_poly_ma)
lnd <- read_sf("https://github.com/Robinlovelace/Creating-maps-in-R/tree/master/data/london_sport.shp")
getwd()
setwd("D:/github/geocourse/slides")
lnd <- read_sf("../data/london_sport.shp")
lnd <- read_sf("../data/london_sport.shp")
plot(lnd)
